@import "tailwindcss";

/* ── Theme tokens ──────────────────────────────────────────────────────────── */
@theme {
  /* Font */
  --font-mono: var(--font-roboto-mono), ui-monospace, monospace;

  /* ── Dark theme — "Nordic Obsidian" (default) ── */
  --color-no-bg:       #1A1C1E;
  --color-no-panel:    #1F2226;
  --color-no-card:     #252A30;
  --color-no-border:   #2F3337;
  --color-no-text:     #E1E2E5;
  --color-no-muted:    #6C7380;
  --color-no-blue:     #74A0FF;
  --color-no-blue-fg:  #1A1C1E;   /* text on no-blue buttons */
  --color-no-blue-dim: #5B8FFF;   /* hover state of no-blue */
  --color-no-gold:     #FFD700;
}

/* ── Light theme — "Academic Manuscript" ──────────────────────────────────── */
html[data-theme="light"] {
  --color-no-bg:       #F9F7F2;
  --color-no-panel:    #F0EDE4;
  --color-no-card:     #E8E4D9;
  --color-no-border:   #D5D0C4;
  --color-no-text:     #2C2921;
  --color-no-muted:    #7A6B58;
  --color-no-blue:     #8B4513;   /* saddle brown — the "ink" accent */
  --color-no-blue-fg:  #F9F7F2;   /* light text on dark-brown button */
  --color-no-blue-dim: #7A3B1A;   /* hover state of no-blue */
  --color-no-gold:     #A0720A;
}

/* ── Non-token CSS vars — range overlays, dot pulse, timeline palette ─────── */
:root {
  --range-overlay:  rgba(10, 12, 14, 0.62);
  --range-line:     rgba(116, 160, 255, 0.7);
  --range-glow:     rgba(116, 160, 255, 0.25);
  --drawer-shadow:  4px 0 40px rgba(0, 0, 0, 0.55);

  /* Active dot + pulse glow color */
  --active-dot-color: #ffffff;
  --dot-pulse-color:  #ffffff;

  /* Per-timeline palette — dark defaults */
  --t-color-0: #74A0FF;   /* blue  — Global History */
  --t-color-1: #FFD700;   /* gold  — Personal */
  --t-color-2: #FF6B9D;   /* rose */
  --t-color-3: #4ECCA3;   /* teal */
  --t-color-4: #FF9F43;   /* amber */
}

html[data-theme="light"] {
  --range-overlay:  rgba(100, 88, 76, 0.42);
  --range-line:     rgba(139, 69, 19, 0.65);
  --range-glow:     rgba(139, 69, 19, 0.15);
  --drawer-shadow:  4px 0 40px rgba(0, 0, 0, 0.12);

  /* Active dot visible on parchment */
  --active-dot-color: #2c2921;
  --dot-pulse-color:  #2c2921;

  /* Per-timeline palette — darker shades readable on parchment */
  --t-color-0: #2A5FD4;   /* deeper blue */
  --t-color-1: #9B6800;   /* dark amber — replaces bright yellow */
  --t-color-2: #C2185B;   /* deep rose */
  --t-color-3: #1A7A5E;   /* forest teal */
  --t-color-4: #C45000;   /* burnt orange */
}

html {
  font-size: 18px;
}

html,
body {
  margin: 0;
  padding: 0;
  background: var(--color-no-bg);
  color: var(--color-no-text);
  overflow: hidden;
  height: 100%;
  font-family: var(--font-mono);
}

/* Active note dot — scale-pulse with expanding ring (color adapts to theme) */
@keyframes dot-pulse {
  0%   { transform: scale(1.2);
         box-shadow: 0 0 0 0   color-mix(in srgb, var(--dot-pulse-color) 60%, transparent),
                               0 0 10px 3px color-mix(in srgb, var(--dot-pulse-color) 30%, transparent); }
  60%  { transform: scale(1.5);
         box-shadow: 0 0 0 7px color-mix(in srgb, var(--dot-pulse-color) 0%, transparent),
                               0 0 16px 5px color-mix(in srgb, var(--dot-pulse-color) 15%, transparent); }
  100% { transform: scale(1.2);
         box-shadow: 0 0 0 0   color-mix(in srgb, var(--dot-pulse-color) 60%, transparent),
                               0 0 10px 3px color-mix(in srgb, var(--dot-pulse-color) 30%, transparent); }
}
.dot-pulse { animation: dot-pulse 1.6s ease-in-out infinite; }

/* Global themed scrollbar — all overflow areas adapt to dark/light theme */
* {
  scrollbar-width: thin;
  scrollbar-color: var(--color-no-border) transparent;
}
*::-webkit-scrollbar {
  width: 4px;
  height: 4px;
}
*::-webkit-scrollbar-track {
  background: transparent;
}
*::-webkit-scrollbar-thumb {
  background: var(--color-no-border);
  border-radius: 99px;
}
*::-webkit-scrollbar-thumb:hover {
  background: var(--color-no-muted);
}

/* Hide scrollbar, keep scrolling */
.timeline-scroll {
  scrollbar-width: none;
  -ms-overflow-style: none;
}
.timeline-scroll::-webkit-scrollbar {
  display: none;
}

/* Slim themed scrollbar for panels */
.panel-scroll {
  scrollbar-width: thin;
  scrollbar-color: var(--color-no-border) transparent;
}
.panel-scroll::-webkit-scrollbar {
  width: 3px;
}
.panel-scroll::-webkit-scrollbar-track {
  background: transparent;
}
.panel-scroll::-webkit-scrollbar-thumb {
  background: var(--color-no-border);
  border-radius: 99px;
}
.panel-scroll::-webkit-scrollbar-thumb:hover {
  background: var(--color-no-muted);
}

/* ── Markdown editor — theme overrides ────────────────────────────────────── */
.md-editor-wrapper .w-md-editor {
  background: transparent !important;
  border: 1px solid var(--color-no-border) !important;
  border-radius: 0.5rem !important;
  font-family: var(--font-mono) !important;
  box-shadow: none !important;
  color: var(--color-no-text) !important;
}

.md-editor-wrapper .w-md-editor .w-md-editor-toolbar {
  background: color-mix(in srgb, var(--color-no-card) 60%, transparent) !important;
  border-bottom: 1px solid var(--color-no-border) !important;
  border-radius: 0.5rem 0.5rem 0 0 !important;
  padding: 2px 4px !important;
  min-height: 32px !important;
}

.md-editor-wrapper .w-md-editor .w-md-editor-toolbar ul > li > button {
  color: var(--color-no-muted) !important;
  height: 24px !important;
  width: 24px !important;
}
.md-editor-wrapper .w-md-editor .w-md-editor-toolbar ul > li > button:hover {
  color: var(--color-no-blue) !important;
  background: color-mix(in srgb, var(--color-no-blue) 10%, transparent) !important;
}

.md-editor-wrapper .w-md-editor .w-md-editor-toolbar ul > li.active > button {
  color: var(--color-no-blue) !important;
}

/* Toolbar divider */
.md-editor-wrapper .w-md-editor .w-md-editor-toolbar ul > li[data-name="divider"] {
  border-left-color: var(--color-no-border) !important;
}

/* Editor text area */
.md-editor-wrapper .w-md-editor-text-input,
.md-editor-wrapper .w-md-editor-text {
  font-family: var(--font-mono) !important;
  font-size: 13px !important;
  line-height: 1.6 !important;
  color: var(--color-no-text) !important;
}

.md-editor-wrapper .w-md-editor-text-input::placeholder {
  color: var(--color-no-muted) !important;
  opacity: 0.5 !important;
}

/* Preview pane */
.md-editor-wrapper .wmde-markdown {
  background: transparent !important;
  font-family: var(--font-mono) !important;
  font-size: 13px !important;
  color: var(--color-no-text) !important;
}

.md-editor-wrapper .wmde-markdown h1,
.md-editor-wrapper .wmde-markdown h2,
.md-editor-wrapper .wmde-markdown h3,
.md-editor-wrapper .wmde-markdown h4,
.md-editor-wrapper .wmde-markdown h5,
.md-editor-wrapper .wmde-markdown h6 {
  color: var(--color-no-text) !important;
  border-bottom-color: var(--color-no-border) !important;
}

.md-editor-wrapper .wmde-markdown a {
  color: var(--color-no-blue) !important;
}

.md-editor-wrapper .wmde-markdown code {
  background: var(--color-no-card) !important;
  color: var(--color-no-blue) !important;
  border-radius: 4px !important;
  padding: 1px 4px !important;
}

.md-editor-wrapper .wmde-markdown pre {
  background: var(--color-no-card) !important;
  border: 1px solid var(--color-no-border) !important;
  border-radius: 6px !important;
}

.md-editor-wrapper .wmde-markdown pre code {
  color: var(--color-no-text) !important;
}

.md-editor-wrapper .wmde-markdown blockquote {
  border-left-color: var(--color-no-blue) !important;
  color: var(--color-no-muted) !important;
}

.md-editor-wrapper .wmde-markdown hr {
  border-color: var(--color-no-border) !important;
}

.md-editor-wrapper .wmde-markdown table th,
.md-editor-wrapper .wmde-markdown table td {
  border-color: var(--color-no-border) !important;
}

.md-editor-wrapper .wmde-markdown table tr:nth-child(2n) {
  background: color-mix(in srgb, var(--color-no-card) 50%, transparent) !important;
}

/* Code mirror syntax highlighting overrides */
.md-editor-wrapper .w-md-editor .token.punctuation { color: var(--color-no-muted) !important; }
.md-editor-wrapper .w-md-editor .token.bold { color: var(--color-no-text) !important; font-weight: bold; }
.md-editor-wrapper .w-md-editor .token.italic { color: var(--color-no-text) !important; font-style: italic; }
.md-editor-wrapper .w-md-editor .token.title { color: var(--color-no-blue) !important; font-weight: bold; }
.md-editor-wrapper .w-md-editor .token.url { color: var(--color-no-blue) !important; }
.md-editor-wrapper .w-md-editor .token.list { color: var(--color-no-gold) !important; }
.md-editor-wrapper .w-md-editor .token.code { color: var(--color-no-blue) !important; }
