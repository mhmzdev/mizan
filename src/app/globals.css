@import "tailwindcss";

/* ── Theme tokens ──────────────────────────────────────────────────────────── */
@theme {
  /* Font */
  --font-mono: var(--font-roboto-mono), ui-monospace, monospace;

  /* ── Dark theme — "Nordic Obsidian" (default) ── */
  --color-no-bg:       #1A1C1E;
  --color-no-panel:    #1F2226;
  --color-no-card:     #252A30;
  --color-no-border:   #2F3337;
  --color-no-text:     #E1E2E5;
  --color-no-muted:    #6C7380;
  --color-no-blue:     #74A0FF;
  --color-no-blue-fg:  #1A1C1E;   /* text on no-blue buttons */
  --color-no-blue-dim: #5B8FFF;   /* hover state of no-blue */
  --color-no-gold:     #FFD700;
}

/* ── Light theme — "Academic Manuscript" ──────────────────────────────────── */
html[data-theme="light"] {
  --color-no-bg:       #F9F7F2;
  --color-no-panel:    #F0EDE4;
  --color-no-card:     #E8E4D9;
  --color-no-border:   #D5D0C4;
  --color-no-text:     #2C2921;
  --color-no-muted:    #7A6B58;
  --color-no-blue:     #8B4513;   /* saddle brown — the "ink" accent */
  --color-no-blue-fg:  #F9F7F2;   /* light text on dark-brown button */
  --color-no-blue-dim: #7A3B1A;   /* hover state of no-blue */
  --color-no-gold:     #A0720A;
}

/* ── Non-token CSS vars — range overlays, dot pulse, timeline palette ─────── */
:root {
  --range-overlay:  rgba(10, 12, 14, 0.62);
  --range-line:     rgba(116, 160, 255, 0.7);
  --range-glow:     rgba(116, 160, 255, 0.25);
  --drawer-shadow:  4px 0 40px rgba(0, 0, 0, 0.55);

  /* Active dot + pulse glow color */
  --active-dot-color: #ffffff;
  --dot-pulse-color:  #ffffff;

  /* Per-timeline palette — dark defaults */
  --t-color-0: #74A0FF;   /* blue  — Global History */
  --t-color-1: #FFD700;   /* gold  — Personal */
  --t-color-2: #FF6B9D;   /* rose */
  --t-color-3: #4ECCA3;   /* teal */
  --t-color-4: #FF9F43;   /* amber */
}

html[data-theme="light"] {
  --range-overlay:  rgba(100, 88, 76, 0.42);
  --range-line:     rgba(139, 69, 19, 0.65);
  --range-glow:     rgba(139, 69, 19, 0.15);
  --drawer-shadow:  4px 0 40px rgba(0, 0, 0, 0.12);

  /* Active dot visible on parchment */
  --active-dot-color: #2c2921;
  --dot-pulse-color:  #2c2921;

  /* Per-timeline palette — darker shades readable on parchment */
  --t-color-0: #2A5FD4;   /* deeper blue */
  --t-color-1: #9B6800;   /* dark amber — replaces bright yellow */
  --t-color-2: #C2185B;   /* deep rose */
  --t-color-3: #1A7A5E;   /* forest teal */
  --t-color-4: #C45000;   /* burnt orange */
}

html {
  font-size: 18px;
}

html,
body {
  margin: 0;
  padding: 0;
  background: var(--color-no-bg);
  color: var(--color-no-text);
  overflow: hidden;
  height: 100%;
  font-family: var(--font-mono);
}

/* Undo toast progress bar — shrinks from full width to 0 */
@keyframes undo-progress {
  from { width: 100%; }
  to   { width: 0%; }
}

/* Active note dot — scale-pulse with expanding ring (color adapts to theme) */
@keyframes dot-pulse {
  0%   { transform: scale(1.2);
         box-shadow: 0 0 0 0   color-mix(in srgb, var(--dot-pulse-color) 60%, transparent),
                               0 0 10px 3px color-mix(in srgb, var(--dot-pulse-color) 30%, transparent); }
  60%  { transform: scale(1.5);
         box-shadow: 0 0 0 7px color-mix(in srgb, var(--dot-pulse-color) 0%, transparent),
                               0 0 16px 5px color-mix(in srgb, var(--dot-pulse-color) 15%, transparent); }
  100% { transform: scale(1.2);
         box-shadow: 0 0 0 0   color-mix(in srgb, var(--dot-pulse-color) 60%, transparent),
                               0 0 10px 3px color-mix(in srgb, var(--dot-pulse-color) 30%, transparent); }
}
.dot-pulse { animation: dot-pulse 1.6s ease-in-out infinite; }

/* Global themed scrollbar — all overflow areas adapt to dark/light theme */
* {
  scrollbar-width: thin;
  scrollbar-color: var(--color-no-border) transparent;
}
*::-webkit-scrollbar {
  width: 4px;
  height: 4px;
}
*::-webkit-scrollbar-track {
  background: transparent;
}
*::-webkit-scrollbar-thumb {
  background: var(--color-no-border);
  border-radius: 99px;
}
*::-webkit-scrollbar-thumb:hover {
  background: var(--color-no-muted);
}

/* Hide scrollbar, keep scrolling */
.timeline-scroll {
  scrollbar-width: none;
  -ms-overflow-style: none;
}
.timeline-scroll::-webkit-scrollbar {
  display: none;
}

/* Slim themed scrollbar for panels */
.panel-scroll {
  scrollbar-width: thin;
  scrollbar-color: var(--color-no-border) transparent;
}
.panel-scroll::-webkit-scrollbar {
  width: 3px;
}
.panel-scroll::-webkit-scrollbar-track {
  background: transparent;
}
.panel-scroll::-webkit-scrollbar-thumb {
  background: var(--color-no-border);
  border-radius: 99px;
}
.panel-scroll::-webkit-scrollbar-thumb:hover {
  background: var(--color-no-muted);
}

/* ── Tiptap WYSIWYG editor ─────────────────────────────────────────────────── */
.tiptap-prose {
  font-family: var(--font-mono);
  font-size: 14px;
  line-height: 1.65;
  color: var(--color-no-text);
  caret-color: var(--color-no-text);
}

/* Paragraph spacing */
.tiptap-prose p { margin: 0 0 0.45em; }
.tiptap-prose p:last-child { margin-bottom: 0; }

/* Headings */
.tiptap-prose h1 { font-size: 2em;   font-weight: 700; margin: 0.9em 0 0.35em; color: var(--color-no-text); line-height: 1.2; }
.tiptap-prose h2 { font-size: 1.55em; font-weight: 700; margin: 0.85em 0 0.3em; color: var(--color-no-text); line-height: 1.25; }
.tiptap-prose h3 { font-size: 1.25em; font-weight: 600; margin: 0.8em 0 0.25em; color: var(--color-no-text); line-height: 1.3; }
.tiptap-prose h1:first-child,
.tiptap-prose h2:first-child,
.tiptap-prose h3:first-child { margin-top: 0; }

/* Inline */
.tiptap-prose strong { font-weight: 700; }
.tiptap-prose em     { font-style: italic; }
.tiptap-prose s      { text-decoration: line-through; color: var(--color-no-muted); }
.tiptap-prose code   { background: var(--color-no-card); color: var(--color-no-blue); border-radius: 3px; padding: 1px 5px; font-size: 0.9em; }

/* Code block */
.tiptap-prose pre {
  background: var(--color-no-card);
  border: 1px solid var(--color-no-border);
  border-radius: 6px;
  padding: 0.75em 1em;
  margin: 0.6em 0;
  overflow-x: auto;
}
.tiptap-prose pre code { background: none; padding: 0; color: var(--color-no-text); font-size: 0.85em; }

/* Lists */
.tiptap-prose ul  { list-style: disc;    padding-left: 1.4em; margin: 0.4em 0; }
.tiptap-prose ol  { list-style: decimal; padding-left: 1.4em; margin: 0.4em 0; }
.tiptap-prose li  { margin: 0.15em 0; }

/* Blockquote */
.tiptap-prose blockquote {
  border-left: 3px solid var(--color-no-blue);
  padding-left: 0.9em;
  color: var(--color-no-muted);
  margin: 0.5em 0;
  font-style: italic;
}

/* Horizontal rule */
.tiptap-prose hr { border: none; border-top: 1px solid var(--color-no-border); margin: 0.9em 0; }

/* Placeholder */
.tiptap-prose p.is-editor-empty:first-child::before {
  content: attr(data-placeholder);
  color: var(--color-no-muted);
  opacity: 0.45;
  pointer-events: none;
  float: left;
  height: 0;
}

/* Links */
.tiptap-prose a {
  color: var(--color-no-blue);
  text-decoration: none;
  cursor: text;
}

/* Raw [text](url) brackets shown when cursor is inside a link */
.link-raw-syntax {
  color: var(--color-no-muted);
  opacity: 0.6;
  font-size: 0.85em;
}
